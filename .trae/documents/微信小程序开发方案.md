# MemBuddy 微信小程序开发方案

## 1. 项目概述

MemBuddy是一个记忆辅助应用，主要功能包括用户认证、记忆内容管理、AI生成记忆辅助工具、复习计划和内容分享。本方案旨在基于现有Web端功能，开发功能和样式统一的微信小程序版本。

## 2. 技术架构对比

### 2.1 Web端技术栈
- **框架**: Next.js 14 + React 18
- **样式**: Tailwind CSS + shadcn/ui组件库
- **状态管理**: React Hooks
- **API通信**: 自定义API配置
- **认证**: JWT + Supabase
- **UI组件**: Radix UI + 自定义组件

### 2.2 小程序端技术选型
- **开发方式**: 微信小程序原生开发
- **样式**: WXSS + 自定义样式库（模拟Tailwind风格）
- **状态管理**: 小程序全局状态 + 页面状态
- **API通信**: wx.request封装
- **认证**: 微信登录 + 后端JWT
- **UI组件**: 原生组件 + 自定义组件库

## 3. 项目结构设计

```
mina/
├── app.js                 # 小程序入口文件
├── app.json              # 全局配置
├── app.wxss              # 全局样式
├── sitemap.json          # 搜索配置
├── project.config.json   # 项目配置
├── pages/                # 页面目录
│   ├── index/           # 首页
│   │   ├── index.js
│   │   ├── index.json
│   │   ├── index.wxml
│   │   └── index.wxss
│   ├── auth/            # 认证相关页面
│   │   ├── login/
│   │   └── register/
│   ├── memory-library/  # 记忆库
│   ├── memory-item/     # 记忆详情
│   ├── review/          # 复习页面
│   └── profile/         # 个人中心
├── components/          # 自定义组件
│   ├── memory-aids/     # 记忆辅助组件
│   │   ├── mind-map/
│   │   ├── mnemonic/
│   │   └── sensory/
│   ├── ui/              # UI基础组件
│   │   ├── button/
│   │   ├── card/
│   │   ├── input/
│   │   └── loading/
│   └── layout/          # 布局组件
├── utils/               # 工具函数
│   ├── api.js          # API封装
│   ├── auth.js         # 认证管理
│   ├── storage.js      # 本地存储
│   └── date.js         # 日期处理
├── styles/              # 样式库
│   ├── variables.wxss  # 变量定义
│   ├── base.wxss       # 基础样式
│   └── components.wxss # 组件样式
└── assets/              # 静态资源
    ├── images/
    └── icons/
```

## 4. 核心功能模块

### 4.1 用户认证模块
- **微信登录**: 使用wx.login获取code，调用后端接口完成登录
- **用户状态管理**: 全局存储用户信息和token
- **自动登录**: 启动时检查本地token有效性

### 4.2 记忆内容管理
- **内容创建**: 文本输入 + AI生成记忆辅助
- **内容列表**: 分页加载，支持搜索和筛选
- **内容详情**: 展示完整记忆内容和辅助工具
- **内容编辑**: 修改记忆内容和标签

### 4.3 记忆辅助工具
- **思维导图**: 使用Canvas API绘制交互式思维导图
- **记忆法**: 卡片式展示记忆技巧
- **感官联想**: 多媒体展示感官记忆

### 4.4 复习系统
- **复习计划**: 基于遗忘曲线的智能提醒
- **复习记录**: 记录复习效果和掌握程度
- **统计分析**: 学习进度和效果统计

### 4.5 分享功能
- **内容分享**: 生成分享链接或小程序码
- **社交分享**: 分享到微信好友或朋友圈

## 5. 样式统一策略

### 5.1 设计系统
- **色彩方案**: 保持与Web端一致的主色调和辅助色
- **字体系统**: 适配小程序字体规范
- **间距系统**: 使用统一的间距变量
- **圆角和阴影**: 保持一致的视觉风格

### 5.2 组件库设计
```wxss
/* 变量定义 */
:root {
  --primary-color: #3b82f6;
  --secondary-color: #64748b;
  --success-color: #10b981;
  --warning-color: #f59e0b;
  --error-color: #ef4444;
  --background-color: #ffffff;
  --surface-color: #f8fafc;
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --border-color: #e2e8f0;
  --radius-sm: 6rpx;
  --radius-md: 12rpx;
  --radius-lg: 16rpx;
  --spacing-xs: 8rpx;
  --spacing-sm: 16rpx;
  --spacing-md: 24rpx;
  --spacing-lg: 32rpx;
  --spacing-xl: 48rpx;
}
```

### 5.3 响应式适配
- **屏幕适配**: 使用rpx单位适配不同屏幕尺寸
- **安全区域**: 适配iPhone X等异形屏
- **横竖屏**: 支持横竖屏切换

## 6. 开发步骤

### 6.1 第一阶段：基础框架搭建（1-2天）
1. 创建小程序项目结构
2. 配置开发环境和构建工具
3. 搭建基础样式系统
4. 实现API通信封装
5. 完成用户认证流程

### 6.2 第二阶段：核心功能开发（3-5天）
1. 实现首页和记忆内容创建
2. 开发记忆库列表和搜索
3. 完成记忆详情页面
4. 实现基础的记忆辅助工具展示

### 6.3 第三阶段：高级功能开发（3-4天）
1. 开发交互式思维导图
2. 实现复习系统
3. 完成分享功能
4. 添加统计和分析功能

### 6.4 第四阶段：优化和测试（2-3天）
1. 性能优化和体验优化
2. 兼容性测试
3. 功能测试和bug修复
4. 准备上线材料

## 7. 关键技术实现

### 7.1 API封装
```javascript
// utils/api.js
class ApiManager {
  constructor() {
    this.baseURL = 'https://api.membuddy.ravey.site'
    this.token = wx.getStorageSync('token')
  }

  request(options) {
    return new Promise((resolve, reject) => {
      wx.request({
        url: this.baseURL + options.url,
        method: options.method || 'GET',
        data: options.data,
        header: {
          'Content-Type': 'application/json',
          'Authorization': this.token ? `Bearer ${this.token}` : ''
        },
        success: (res) => {
          if (res.statusCode === 200) {
            resolve(res.data)
          } else {
            reject(new Error(res.data.message || '请求失败'))
          }
        },
        fail: reject
      })
    })
  }
}
```

### 7.2 状态管理
```javascript
// utils/store.js
class Store {
  constructor() {
    this.state = {
      user: null,
      memoryItems: [],
      loading: false
    }
    this.listeners = []
  }

  setState(newState) {
    this.state = { ...this.state, ...newState }
    this.listeners.forEach(listener => listener(this.state))
  }

  subscribe(listener) {
    this.listeners.push(listener)
    return () => {
      this.listeners = this.listeners.filter(l => l !== listener)
    }
  }
}
```

### 7.3 组件化开发
```javascript
// components/ui/button/button.js
Component({
  properties: {
    type: {
      type: String,
      value: 'primary'
    },
    size: {
      type: String,
      value: 'medium'
    },
    disabled: {
      type: Boolean,
      value: false
    },
    loading: {
      type: Boolean,
      value: false
    }
  },
  methods: {
    handleTap() {
      if (!this.data.disabled && !this.data.loading) {
        this.triggerEvent('tap')
      }
    }
  }
})
```

## 8. 性能优化策略

### 8.1 代码优化
- **按需加载**: 使用分包加载减少首屏加载时间
- **图片优化**: 使用WebP格式，实现懒加载
- **缓存策略**: 合理使用本地存储和内存缓存

### 8.2 用户体验优化
- **加载状态**: 提供友好的加载提示
- **错误处理**: 完善的错误提示和重试机制
- **离线支持**: 基础功能的离线可用性

## 9. 测试策略

### 9.1 功能测试
- 用户认证流程测试
- 核心功能完整性测试
- 边界条件和异常情况测试

### 9.2 兼容性测试
- 不同机型适配测试
- 不同微信版本兼容性测试
- 网络环境适应性测试

### 9.3 性能测试
- 启动时间测试
- 页面切换流畅度测试
- 内存使用情况监控

## 10. 上线准备

### 10.1 小程序配置
- 完善小程序基本信息
- 配置服务器域名白名单
- 设置用户隐私保护指引

### 10.2 审核准备
- 准备应用截图和介绍
- 完善用户协议和隐私政策
- 确保符合微信小程序规范

## 11. 后续维护

### 11.1 版本管理
- 建立版本发布流程
- 实现灰度发布机制
- 监控线上问题和用户反馈

### 11.2 功能迭代
- 根据用户反馈优化功能
- 与Web端保持功能同步
- 探索小程序特有功能

通过以上方案，可以确保微信小程序版本与Web端保持功能和样式的高度统一，同时充分利用小程序平台的特性，为用户提供优质的移动端记忆辅助体验。